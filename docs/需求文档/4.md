下面直接给你**可复制可跑**的最小版本：`⌘K` 全局搜索弹窗（Scope + 分组结果）。你按文件粘贴就行。

---

## 1) 新建：`src/search/searchIndex.ts`

```ts
// src/search/searchIndex.ts
export type SearchType = "project" | "market" | "evidence" | "page";

export type SearchItem = {
  id: string;
  type: SearchType;
  title: string;
  subtitle?: string;
  tags?: string[];
  href: string; // React Router 跳转路径
  meta?: Record<string, string | number>;
};

export const SEARCH_INDEX: SearchItem[] = [
  // Projects
  {
    id: "p_bobo",
    type: "project",
    title: "Bobo The Bear",
    subtitle: "BOBO · Heat 33.3 · Phase P1",
    tags: ["meme", "accelerator", "p1"],
    href: "/projects/bobo",
  },
  {
    id: "p_coomer",
    type: "project",
    title: "Coomer",
    subtitle: "COOMER · Heat 26.4 · Phase P1",
    tags: ["p1"],
    href: "/projects/coomer",
  },

  // Markets (Milestones)
  {
    id: "m_bobo_hackathon",
    type: "market",
    title: "Hackathon",
    subtitle: "Bobo The Bear · YES 36¢ / NO 64¢",
    tags: ["milestone", "trade"],
    href: "/projects/bobo?market=hackathon",
  },
  {
    id: "m_bobo_shipping",
    type: "market",
    title: "Shipping",
    subtitle: "Bobo The Bear · YES 33¢ / NO 67¢",
    tags: ["milestone", "trade"],
    href: "/projects/bobo?market=shipping",
  },

  // Evidence
  {
    id: "e_demo_link",
    type: "evidence",
    title: "提交证据：Demo 链接",
    subtitle: "by User 9C...80bc · 10m ago",
    tags: ["evidence"],
    href: "/projects/bobo?tab=evidence",
  },
  {
    id: "e_multisig_2of5",
    type: "evidence",
    title: "多签签名进度：2/5",
    subtitle: "by Resolver · 5m ago",
    tags: ["resolver"],
    href: "/projects/bobo?tab=evidence",
  },

  // Pages
  { id: "pg_heat", type: "page", title: "热度榜", subtitle: "发现热项目", href: "/heat" },
  { id: "pg_1usd", type: "page", title: "$1 Accelerator", subtitle: "新项目加速器", href: "/1usd" },
  { id: "pg_arena", type: "page", title: "比赛区", subtitle: "挑战/任务/对赌", href: "/arena" },
  { id: "pg_insurance", type: "page", title: "保险区", subtitle: "爆仓保 / LiqPass", href: "/insurance" },
];

export function typeLabel(t: SearchType) {
  if (t === "project") return "PROJECT";
  if (t === "market") return "MARKET";
  if (t === "evidence") return "EVIDENCE";
  return "PAGE";
}
```

---

## 2) 新建：`src/search/searchCore.ts`

```ts
// src/search/searchCore.ts
import { SEARCH_INDEX, SearchItem, SearchType } from "./searchIndex";

export type Scope = "all" | SearchType;

function normalize(s: string) {
  return s.trim().toLowerCase();
}

export function searchItems(query: string, scope: Scope, limitPerGroup = 4) {
  const q = normalize(query);
  if (!q) return groupItems([], limitPerGroup);

  const hits = SEARCH_INDEX.filter((it) => {
    if (scope !== "all" && it.type !== scope) return false;

    const hay = [
      it.title,
      it.subtitle ?? "",
      (it.tags ?? []).join(" "),
    ].join(" ");
    return normalize(hay).includes(q);
  });

  // 简单排序：project > market > evidence > page，再按 title
  const priority: Record<SearchType, number> = {
    project: 0,
    market: 1,
    evidence: 2,
    page: 3,
  };

  hits.sort((a, b) => {
    const pa = priority[a.type];
    const pb = priority[b.type];
    if (pa !== pb) return pa - pb;
    return a.title.localeCompare(b.title);
  });

  return groupItems(hits, limitPerGroup);
}

function groupItems(items: SearchItem[], limitPerGroup: number) {
  const groups: Record<SearchType, SearchItem[]> = {
    project: [],
    market: [],
    evidence: [],
    page: [],
  };

  for (const it of items) groups[it.type].push(it);

  return {
    groups,
    // 每组只显示前 N 条（All 模式用）
    limited: {
      project: groups.project.slice(0, limitPerGroup),
      market: groups.market.slice(0, limitPerGroup),
      evidence: groups.evidence.slice(0, limitPerGroup),
      page: groups.page.slice(0, limitPerGroup),
    },
    counts: {
      project: groups.project.length,
      market: groups.market.length,
      evidence: groups.evidence.length,
      page: groups.page.length,
    },
  };
}
```

---

## 3) 新建：`src/search/GlobalSearchModal.tsx`

```tsx
// src/search/GlobalSearchModal.tsx
import React, { useEffect, useMemo, useRef, useState } from "react";
import { useLocation, useNavigate } from "react-router-dom";
import { Search, CornerDownLeft } from "lucide-react";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Badge } from "@/components/ui/badge";
import { Separator } from "@/components/ui/separator";
import { Card } from "@/components/ui/card";

import { searchItems, Scope } from "./searchCore";
import { SearchItem, typeLabel } from "./searchIndex";

const scopes: { key: Scope; label: string }[] = [
  { key: "all", label: "All" },
  { key: "project", label: "Projects" },
  { key: "market", label: "Markets" },
  { key: "evidence", label: "Evidence" },
  { key: "page", label: "Pages" },
];

export function GlobalSearchModal() {
  const nav = useNavigate();
  const loc = useLocation();

  const [open, setOpen] = useState(false);
  const [scope, setScope] = useState<Scope>("all");
  const [q, setQ] = useState("");
  const inputRef = useRef<HTMLInputElement | null>(null);

  // ⌘K / Ctrl+K 打开
  useEffect(() => {
    const onKey = (e: KeyboardEvent) => {
      const isK = e.key.toLowerCase() === "k";
      const mod = e.metaKey || e.ctrlKey;
      if (mod && isK) {
        e.preventDefault();
        setOpen(true);
      }
      if (e.key === "Escape") setOpen(false);
    };
    window.addEventListener("keydown", onKey);
    return () => window.removeEventListener("keydown", onKey);
  }, []);

  // 打开时聚焦
  useEffect(() => {
    if (!open) return;
    setTimeout(() => inputRef.current?.focus(), 0);
  }, [open]);

  // 路由变更自动关闭（点结果跳走时）
  useEffect(() => {
    if (open) setOpen(false);
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [loc.key]);

  const res = useMemo(() => searchItems(q, scope, 4), [q, scope]);

  const go = (item: SearchItem) => {
    nav(item.href);
  };

  if (!open) {
    // 顶部入口按钮：你可以放到 TopNav 右侧
    return (
      <Button
        variant="outline"
        className="h-9 gap-2"
        onClick={() => setOpen(true)}
        aria-label="Search"
        title="Search (⌘K)"
      >
        <Search className="h-4 w-4" />
        <span className="hidden sm:inline">Search</span>
        <span className="ml-1 hidden rounded-md border px-1.5 py-0.5 text-xs text-muted-foreground sm:inline">
          ⌘K
        </span>
      </Button>
    );
  }

  return (
    <div className="fixed inset-0 z-[80]">
      {/* overlay */}
      <div
        className="absolute inset-0 bg-black/40"
        onClick={() => setOpen(false)}
      />

      {/* modal */}
      <div className="absolute left-1/2 top-[12vh] w-[92vw] max-w-2xl -translate-x-1/2">
        <Card className="overflow-hidden rounded-2xl border bg-white shadow-2xl">
          <div className="flex items-center gap-2 px-4 py-3">
            <Search className="h-4 w-4 text-muted-foreground" />
            <Input
              ref={inputRef}
              value={q}
              onChange={(e) => setQ(e.target.value)}
              placeholder="Search projects, markets, evidence…"
              className="h-10 border-0 focus-visible:ring-0"
            />
            <Button variant="ghost" className="h-9" onClick={() => setOpen(false)}>
              Esc
            </Button>
          </div>

          <Separator />

          {/* scopes */}
          <div className="flex flex-wrap gap-2 px-4 py-3">
            {scopes.map((s) => (
              <Button
                key={s.key}
                size="sm"
                variant={scope === s.key ? "default" : "outline"}
                className="h-8"
                onClick={() => setScope(s.key)}
              >
                {s.label}
              </Button>
            ))}
          </div>

          <Separator />

          <div className="max-h-[52vh] overflow-auto px-2 py-2">
            {scope === "all" ? (
              <div className="space-y-3 px-2 pb-2">
                <Group
                  title="Projects"
                  items={res.limited.project}
                  total={res.counts.project}
                  onPick={go}
                />
                <Group
                  title="Markets"
                  items={res.limited.market}
                  total={res.counts.market}
                  onPick={go}
                />
                <Group
                  title="Evidence"
                  items={res.limited.evidence}
                  total={res.counts.evidence}
                  onPick={go}
                />
                <Group
                  title="Pages"
                  items={res.limited.page}
                  total={res.counts.page}
                  onPick={go}
                />
                {!q.trim() ? (
                  <div className="rounded-xl border bg-slate-50 p-3 text-sm text-muted-foreground">
                    输入关键词，例如：<span className="font-medium text-foreground">bobo</span>、
                    <span className="font-medium text-foreground">hackathon</span>、
                    <span className="font-medium text-foreground">证据</span>。
                  </div>
                ) : null}
              </div>
            ) : (
              <div className="space-y-2 px-2 pb-2">
                <div className="px-2 text-xs text-muted-foreground">
                  {res.groups[scope].length} results
                </div>
                {res.groups[scope].map((it) => (
                  <Row key={it.id} item={it} onPick={go} />
                ))}
              </div>
            )}
          </div>

          <Separator />

          <div className="flex items-center justify-between px-4 py-3 text-xs text-muted-foreground">
            <div className="flex items-center gap-2">
              <CornerDownLeft className="h-3.5 w-3.5" />
              Enter to open
            </div>
            <div>⌘K / Ctrl+K</div>
          </div>
        </Card>
      </div>
    </div>
  );
}

function Group({
  title,
  items,
  total,
  onPick,
}: {
  title: string;
  items: SearchItem[];
  total: number;
  onPick: (it: SearchItem) => void;
}) {
  if (!items.length) return null;
  return (
    <div className="space-y-2">
      <div className="flex items-center justify-between px-2">
        <div className="text-xs font-semibold text-slate-700">{title}</div>
        <div className="text-xs text-muted-foreground">{total}</div>
      </div>
      <div className="space-y-1">
        {items.map((it) => (
          <Row key={it.id} item={it} onPick={onPick} />
        ))}
      </div>
    </div>
  );
}

function Row({ item, onPick }: { item: SearchItem; onPick: (it: SearchItem) => void }) {
  return (
    <button
      className="flex w-full items-start justify-between gap-3 rounded-xl border px-3 py-3 text-left transition hover:bg-slate-50"
      type="button"
      onClick={() => onPick(item)}
    >
      <div className="min-w-0">
        <div className="flex items-center gap-2">
          <Badge variant="secondary" className="text-[10px]">
            {typeLabel(item.type)}
          </Badge>
          <div className="truncate text-sm font-medium text-slate-900">{item.title}</div>
        </div>
        {item.subtitle ? (
          <div className="mt-1 line-clamp-1 text-xs text-muted-foreground">{item.subtitle}</div>
        ) : null}
      </div>

      <div className="shrink-0 text-xs text-muted-foreground">↵</div>
    </button>
  );
}
```

---

## 4) 在你的 TopNav 里挂载入口

你现在 TopNav 右侧有 Search input，建议换成这个按钮（更像产品）。

在 `TopNav()` 右侧区域引入：

```tsx
import { GlobalSearchModal } from "@/search/GlobalSearchModal";
```

然后把原来的 `<Input placeholder="Search coin…" />` 替换成：

```tsx
<GlobalSearchModal />
```

---

## 5) 路由说明

你现在 `href` 用的是示例：

* `/projects/bobo`
* `/heat`
* `/1usd`

你按你项目现有路由改一下就行。

---

### 你下一步想要更爽的体验（我可以继续给）

1. 支持上下键选择、Enter 打开
2. 命中词高亮
3. 结果里显示：Heat、Phase、是否争议中、倒计时
4. 搜索数据从你现有 stores（Zustand）自动生成 index

你先把这版跑起来，如果你告诉我你实际路由（项目详情页 path 是啥），我可以把 `href` 映射规则直接改成你的真实结构。
